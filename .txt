The main logic is in restrictedCholeskyAndDeterminant.m
